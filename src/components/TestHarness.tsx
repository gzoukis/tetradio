import React, { useState } from 'react'; import { View, Text, StyleSheet, TouchableOpacity, ScrollView } from 'react-native'; import { resetDatabase } from './db/database'; import { createTask, createExpense, createCollection, createBudgetCategory } from '../db/operations'; export default function TestHarness() { const [testing, setTesting] = useState(false); const runTests = async () => { setTesting(true); try { await createTask({ title: 'Test Task', completed: false }); await createExpense({ amount: 5.50, currency: 'EUR', note: 'Coffee' }); await createCollection({ name: 'Groceries', sort_order: 0, is_pinned: false, is_archived: false }); await createBudgetCategory({ name: 'Food & Drink', sort_order: 0, is_archived: false, limit_currency: 'EUR' }); alert('✓ Test data created'); } catch (error) { alert('✗ Tests failed'); console.error(error); } finally { setTesting(false); } }; const clearAll = async () => { setTesting(true); try { await resetDatabase(); alert('✓ Database reset'); } catch (error) { alert('✗ Reset failed'); console.error(error); } finally { setTesting(false); } }; return ( <ScrollView style={styles.container} contentContainerStyle={styles.content}> <Text style={styles.title}>Test Harness</Text> <Text style={styles.subtitle}>Developer Tools</Text> <TouchableOpacity style={[styles.button, testing && styles.buttonDisabled]} onPress={runTests} disabled={testing} > <Text style={styles.buttonText}> {testing ? 'Running...' : 'Create Test Data'} </Text> </TouchableOpacity> <TouchableOpacity style={[styles.button, styles.buttonDanger, testing && styles.buttonDisabled]} onPress={clearAll} disabled={testing} > <Text style={styles.buttonText}>Reset Database</Text> </TouchableOpacity> </ScrollView> ); } const styles = StyleSheet.create({ container: { flex: 1, backgroundColor: '#fff', }, content: { padding: 20, }, title: { fontSize: 24, fontWeight: 'bold', marginBottom: 8, }, subtitle: { fontSize: 16, color: '#666', marginBottom: 24, }, button: { backgroundColor: '#3b82f6', padding: 16, borderRadius: 8, alignItems: 'center', marginBottom: 12, minHeight: 56, justifyContent: 'center', }, buttonDanger: { backgroundColor: '#ef4444', }, buttonDisabled: { opacity: 0.5, }, buttonText: { color: '#fff', fontSize: 16, fontWeight: '600', }, });